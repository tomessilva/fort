<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="fort() creates an object (that inherits from class FastTransform) which represents a fast random
\(\mathbb{R}^{dim\_in} \to \mathbb{R}^{dim\_out}\) linear transform. This transform will be
orthonormal when \(dim\_in = dim\_out\) and they are a power of 2, and approximately
orthogonal or semi-orthogonal (in the sense that either \(W^T W \approx I_{dim\_in}\) or
\(W W^T \approx I_{dim\_out}\), if \(W\) represents the transform and \(I_n\) represents an
N-dimensional identity matrix) otherwise."><title>Create a Fast Orthogonal Random Transform — fort • fort</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a Fast Orthogonal Random Transform — fort"><meta property="og:description" content="fort() creates an object (that inherits from class FastTransform) which represents a fast random
\(\mathbb{R}^{dim\_in} \to \mathbb{R}^{dim\_out}\) linear transform. This transform will be
orthonormal when \(dim\_in = dim\_out\) and they are a power of 2, and approximately
orthogonal or semi-orthogonal (in the sense that either \(W^T W \approx I_{dim\_in}\) or
\(W W^T \approx I_{dim\_out}\), if \(W\) represents the transform and \(I_n\) represents an
N-dimensional identity matrix) otherwise."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fort</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/fort-basic.html">Using the fort package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tomessilva/fort/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Create a Fast Orthogonal Random Transform</h1>
      <small class="dont-index">Source: <a href="https://github.com/tomessilva/fort/blob/HEAD/R/ft_helper.R" class="external-link"><code>R/ft_helper.R</code></a></small>
      <div class="d-none name"><code>fort.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>fort()</code> creates an object (that inherits from class <a href="FastTransform.html">FastTransform</a>) which represents a fast random
\(\mathbb{R}^{dim\_in} \to \mathbb{R}^{dim\_out}\) linear transform. This transform will be
orthonormal when \(dim\_in = dim\_out\) <em>and</em> they are a power of 2, and approximately
orthogonal or semi-orthogonal (in the sense that either \(W^T W \approx I_{dim\_in}\) or
\(W W^T \approx I_{dim\_out}\), if \(W\) represents the transform and \(I_n\) represents an
N-dimensional identity matrix) otherwise.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fort</span><span class="op">(</span></span>
<span>  <span class="va">dim_in</span>,</span>
<span>  dim_out <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  cache_matrix <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dim_in</dt>
<dd><p>Either a scalar indicating the input dimensionality, or a vector of length 2 indicating
the input and output dimensionality of the transform (if dim_out is not specified).</p></dd>


<dt>dim_out</dt>
<dd><p>A scalar indicating the output dimensionality of the transform (not required if the
first parameter is a vector of length 2).</p></dd>


<dt>type</dt>
<dd><p>A string indicating the type of transform to use (optional); current valid options are:
<code>fft2</code> (i.e. <code>default</code>).</p></dd>


<dt>cache_matrix</dt>
<dd><p>Logical that controls whether matrices are cached when as.matrix() is called;
should be set to FALSE if saving memory is important (optional, default = TRUE).</p></dd>


<dt>seed</dt>
<dd><p>If set, defines the seed used to generate the random transform (optional, default = NULL).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of a class that inherits from class <a href="FastTransform.html">FastTransform</a> and which represents a fast
linear transform.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The goal of <code>fort()</code> is to provide an easy and efficient way of calculating fast orthogonal random
transforms (when <code>dim_in</code> is the same as <code>dim_out</code>) or semi-orthogonal transforms (when <code>dim_in</code> is
different from <code>dim_out</code>) within R, by using fast structured transforms (like the Fast Fourier
Transform or the Fast Walsh-Hadamard Transform) to avoid matrix multiplications, in the same spirit
as the Fastfood (Rahimi et al. (2007)), ACDC (Moczulski et al. (2015)), HD (Yu et al. (2016)) and
SD (Choromanski et al. (2017)) families of random structured transforms.</p>
<p>Internally, all <code>fort</code> transforms assume a blocksize which <em>must</em> be a power of 2 and no smaller
than <code>max(dim_in, dim_out)</code>. The resulting transform will be practically orthonormal when
\(dim\_in = dim\_out\) and they match the blocksize of the transform, and practically semi-orthogonal
when \(dim\_in \neq dim\_out\) and <code>max(dim_in, dim_out)</code> matches the blocksize. Otherwise, these
properties will <em>only approximately</em> hold, since the output will result from a decimated
transform (i.e., the rows and columns of the transform should be decorrelated, but not necessarily
orthogonal).</p>
    </div>
    <div class="section level2">
    <h2 id="fort-transform-types"><code>fort</code> transform types<a class="anchor" aria-label="anchor" href="#fort-transform-types"></a></h2>
    

<p>The specific type of transform returned depends on the value passed in the <code>type</code> parameter,
but all methods rely on alternating between applying permutations (complexity \(O(N)\)),
diagonal scaling matrices (complexity \(O(N)\)) and structured fast linear transforms
(such as the Fast Fourier Transform or the Fast Walsh-Hadamard Transform, which can be
implemented with complexity \(O(N \mathrm{log} N)\)). Thus, it becomes possible to reduce the
complexity of transforming an \(\mathbb{R}^N\) vector from \(O(N^{2})\) (using matrix
multiplication) to \(O(N \mathrm{log} N)\).</p>
<p>Currently, the available options for the <code>type</code> parameter are:</p><ul><li><p><code>default</code>: this is the default option, if no <code>type</code> is specified; currently, it assumes the <code>fft2</code>
type, but this is subject to change (so avoid this option in non-interactive usage);</p></li>
<li><p><code>fft1</code>: this type of <code>fort</code> transform uses the Fast Fourier Transform as base transform (which is
used once); for more technical details, see <a href="FastTransformFFT1.html">FastTransformFFT1</a>.</p></li>
<li><p><code>fft2</code>: this type of <code>fort</code> transform uses the Fast Fourier Transform as base transform (which is
used twice); for more technical details, see <a href="FastTransformFFT2.html">FastTransformFFT2</a>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="using-fort-transforms">Using <code>fort</code> transforms<a class="anchor" aria-label="anchor" href="#using-fort-transforms"></a></h2>
    

<p>In practice, to apply the fast transform to the columns of a matrix, you should use the <code>%*%</code> operator
as if the output of <code>fort()</code> was a matrix (e.g., <code>fort(4,6) %*% matrix(1:12,4,3)</code> will output a 6 by 3
matrix that results from applying the transform on the left to the matrix on the right of the <code>%*%</code>
operator).</p>
<p>Objects generated by <code>fort()</code> are also compatible with other methods applicable to <code>matrix</code> objects,
such as <code><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim()</a></code>, <code><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol()</a></code>, <code><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow()</a></code>, <code><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve()</a></code>, <code><a href="https://rdrr.io/r/base/t.html" class="external-link">t()</a></code> and <code><a href="https://rdrr.io/r/base/det.html" class="external-link">det()</a></code>. Furthermore, these object can also
be easily converted to matrices (using <code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix()</a></code>), if required.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Krzysztof M. Choromanski, Mark Rowland, and Adrian Weller. (2017). The unreasonable effectiveness of structured random orthogonal embeddings. <em>Conference and Workshop on Neural Information Processing Systems</em>. <a href="http://papers.neurips.cc/paper/6626-the-unreasonable-effectiveness-of-structured-random-orthogonal-embeddings" class="external-link">http://papers.neurips.cc/paper/6626-the-unreasonable-effectiveness-of-structured-random-orthogonal-embeddings</a></p>
<p>Felix Xinnan X. Yu, Ananda Theertha Suresh, Krzysztof M. Choromanski, Daniel N. Holtmann-Rice, and Sanjiv Kumar. (2016). Orthogonal random features. <em>Conference and Workshop on Neural Information Processing Systems</em>. <a href="http://papers.neurips.cc/paper/6246-orthogonal-random-features" class="external-link">http://papers.neurips.cc/paper/6246-orthogonal-random-features</a></p>
<p>Marcin Moczulski, Misha Denil, Jeremy Appleyard, and Nando de Freitas. (2015). ACDC: A structured efficient linear layer. <a href="https://arxiv.org/abs/1511.05946" class="external-link">https://arxiv.org/abs/1511.05946</a></p>
<p>Quoc Le, Tamás Sarlós and Alex Smola. (2013). Fastfood - approximating kernel expansions in loglinear time. <em>International Conference on Machine Learning</em>. <a href="https://proceedings.mlr.press/v28/le13-supp.pdf" class="external-link">https://proceedings.mlr.press/v28/le13-supp.pdf</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p>How to apply <code>fort</code> transforms: <code><a href="grapes-times-grapes-.FastTransform.html">%*%.FastTransform</a></code></p></li>
<li><p>How to obtain a <code>fort</code> transform in matrix form: <code><a href="as.matrix.FastTransform.html">as.matrix.FastTransform()</a></code></p></li>
<li><p>How to invert <code>fort</code> transforms: <code><a href="solve.FastTransform.html">solve.FastTransform()</a></code></p></li>
<li><p>How to access low-level functionality of <code>fort</code> transforms: <code><a href="FastTransform.html">FastTransform</a></code></p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">fort</span><span class="op">(</span><span class="fl">16</span><span class="op">)</span> <span class="co"># a random orthogonal transform from R^16 to R^16</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fort linear operation: R^16 -&gt; [fft2] -&gt; R^16</span>
<span class="r-in"><span><span class="fu">fort</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">33</span><span class="op">)</span> <span class="co"># a random transform from R^5 to R^33</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fort linear operation: R^5 -&gt; [R^64 -&gt; fft2 -&gt; R^64] -&gt; R^33</span>
<span class="r-in"><span><span class="fu">fort</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">33</span><span class="op">)</span><span class="op">)</span> <span class="co"># same as previous line</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fort linear operation: R^5 -&gt; [R^64 -&gt; fft2 -&gt; R^64] -&gt; R^33</span>
<span class="r-in"><span><span class="co"># apply a random orthogonal transformation to the canonical R^4 basis</span></span></span>
<span class="r-in"><span><span class="fu">fort</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]       [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.4154727  0.3164209 -0.5961843 -0.6097741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.2290454  0.3251849  0.6623419 -0.6348985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.6097741 -0.5961843 -0.3164209 -0.4154727</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.6348985 -0.6623419  0.3251849 -0.2290454</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Tomé Silva.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

